
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://brace2.github.io/OpenSeesRT/developer/extending/uniaxial/fortran/">
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-, mkdocs-material-8.2.13">
    
    
      
        <title>A FORTRAN Interface for UniaxialMaterial Models - OpenSeesRT</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.e411adfe.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=serif:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"serif";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../math.css">
    
      <link rel="stylesheet" href="../../../../particle.css">
    
      <link rel="stylesheet" href="../../../../grid.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="OpenSeesRT" class="md-header__button md-logo" aria-label="OpenSeesRT" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenSeesRT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A FORTRAN Interface for UniaxialMaterial Models

            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    

  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../../library/analysis/DirectIntegration/" class="md-tabs__link">
        Library
      </a>
    </li>
  

  

  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="OpenSeesRT" class="md-nav__button md-logo" aria-label="OpenSeesRT" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    OpenSeesRT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1">
          Library
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Library" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Library
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1" type="checkbox" id="__nav_1_1" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_1">
          Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Analysis" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_1">
          <span class="md-nav__icon md-icon"></span>
          Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1_1" type="checkbox" id="__nav_1_1_1" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../library/analysis/DirectIntegration/">DirectIntegrationAnalysis</a>
          
            <label for="__nav_1_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="DirectIntegrationAnalysis" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_1_1">
          <span class="md-nav__icon md-icon"></span>
          DirectIntegrationAnalysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/DirectIntegration/231-Explicit%20Difference/" class="md-nav__link">
        Explicit Difference

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/DirectIntegration/277-Generalized%20Alpha%20Method/" class="md-nav__link">
        Generalized Alpha Method

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/DirectIntegration/326-Hilber-Hughes-Taylor%20Method/" class="md-nav__link">
        Hilber-Hughes-Taylor

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/DirectIntegration/416-Newmark%20Method/" class="md-nav__link">
        Newmark Method

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/DirectIntegration/675-TRBDF2/" class="md-nav__link">
        TRBDF2

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/DirectIntegration/81-Central%20Difference/" class="md-nav__link">
        Central Difference

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/DirectIntegration/_implementation/" class="md-nav__link">
        
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1_2" type="checkbox" id="__nav_1_1_2" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_1_2">
          EigenAnalysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="EigenAnalysis" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_1_2">
          <span class="md-nav__icon md-icon"></span>
          EigenAnalysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/Eigen_Analysis/ArpackSolver/" class="md-nav__link">
        ArpackSolver

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/Eigen_Analysis/EigenAlgorithm/" class="md-nav__link">
        
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/Eigen_Analysis/FrequencyAlgo/" class="md-nav__link">
        FrequencyAlgo

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/Eigen_Analysis/StandardEigenAlgo/" class="md-nav__link">
        StandardEigenAlgo

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1_3" type="checkbox" id="__nav_1_1_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../library/analysis/">StaticAnalysis</a>
          
            <label for="__nav_1_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="StaticAnalysis" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_1_3">
          <span class="md-nav__icon md-icon"></span>
          StaticAnalysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/154-Displacement%20Control/" class="md-nav__link">
        Displacement Control

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/24-Arc-Length%20Control/" class="md-nav__link">
        Arc-Length Control

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/372-Load%20Control/" class="md-nav__link">
        Load Control

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/387-Minimum%20Unbalanced%20Displacement%20Norm/" class="md-nav__link">
        Minimum Unbalanced Displacement Norm

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/EQPath/" class="md-nav__link">
        EQPath

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/HSConstraint/" class="md-nav__link">
        HSConstraint

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/" class="md-nav__link">
        StaticAnalysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/LoadPath/" class="md-nav__link">
        LoadPath

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/ParkLMS3/" class="md-nav__link">
        ParkLMS3

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/analysis/StaticAnalysis/StagedLoadControl/" class="md-nav__link">
        StagedLoadControl

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" type="checkbox" id="__nav_1_2" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2">
          Modeling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modeling" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          Modeling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_1" type="checkbox" id="__nav_1_2_1" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_1">
          Uniaxial Material
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Uniaxial Material" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_2_1">
          <span class="md-nav__icon md-icon"></span>
          Uniaxial Material
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_1_1" type="checkbox" id="__nav_1_2_1_1" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_1_1">
          Elastic
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Elastic" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_2_1_1">
          <span class="md-nav__icon md-icon"></span>
          Elastic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/elastic/181-ElasticMultiLinear/" class="md-nav__link">
        ElasticMultiLinear

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/elastic/195-Elastic%20Uniaxial/" class="md-nav__link">
        Elastic

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/elastic/180-ElasticBilin/" class="md-nav__link">
        ElasticBilin

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_1_2" type="checkbox" id="__nav_1_2_1_2" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_1_2">
          Generic
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Generic" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_2_1_2">
          <span class="md-nav__icon md-icon"></span>
          Generic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/bouc/64-BoucWen/" class="md-nav__link">
        BoucWen

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/generic/322-Hardening/" class="md-nav__link">
        Hardening

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/generic/179-Elastic-Perfectly%20Plastic/" class="md-nav__link">
        Elastic-Perfectly Plastic

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/generic/404-MultiLinear/" class="md-nav__link">
        MultiLinear

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_1_3" type="checkbox" id="__nav_1_2_1_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_1_3">
          Metallic
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Metallic" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_2_1_3">
          <span class="md-nav__icon md-icon"></span>
          Metallic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/metallic/666-Steel02/" class="md-nav__link">
        Steel02

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/metallic/668-SteelMPF/" class="md-nav__link">
        SteelMPF

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/metallic/587-Reinforcing%20Steel/" class="md-nav__link">
        ReinforcingSteel

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/metallic/667-Steel4/" class="md-nav__link">
        Steel4

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/metallic/158-DoddRestrepo/" class="md-nav__link">
        DoddRestrepo

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/metallic/730-UVCuniaxial/" class="md-nav__link">
        UVCuniaxial

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/metallic/569-RambergOsgoodSteel/" class="md-nav__link">
        RambergOsgoodSteel

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_1_4" type="checkbox" id="__nav_1_2_1_4" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_1_4">
          Concrete
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Concrete" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_2_1_4">
          <span class="md-nav__icon md-icon"></span>
          Concrete
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/concrete/97-ConfinedConcrete01/" class="md-nav__link">
        ConfinedConcrete01

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/concrete/94-ConcreteCM/" class="md-nav__link">
        ConcreteCM

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/concrete/91-Concrete04/" class="md-nav__link">
        Concrete04
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/concrete/90-Concrete02/" class="md-nav__link">
        Concrete02
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/concrete/92-Concrete06/" class="md-nav__link">
        Concrete06

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/concrete/Concrete02IS/" class="md-nav__link">
        Concrete02IS

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_1_5" type="checkbox" id="__nav_1_2_1_5" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_1_5">
          Geotechnical
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Geotechnical" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_2_1_5">
          <span class="md-nav__icon md-icon"></span>
          Geotechnical
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/geotechnical/557-PySimple1/" class="md-nav__link">
        PySimple1

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/geotechnical/565-QzSimple1/" class="md-nav__link">
        QzSimple1

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_1_6" type="checkbox" id="__nav_1_2_1_6" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_1_6">
          Wrappers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Wrappers" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_2_1_6">
          <span class="md-nav__icon md-icon"></span>
          Wrappers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/wrapper/489-Parallel/" class="md-nav__link">
        Parallel

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/uniaxial/wrapper/632-Series/" class="md-nav__link">
        Series

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_2" type="checkbox" id="__nav_1_2_2" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_2">
          Element
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Element" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_2_2">
          <span class="md-nav__icon md-icon"></span>
          Element
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_2_1" type="checkbox" id="__nav_1_2_2_1" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_2_1">
          Beam
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Beam" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_2_2_1">
          <span class="md-nav__icon md-icon"></span>
          Beam
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/element/beam/2057-Force-Based%20Beam-Column%20Element/" class="md-nav__link">
        Force-Based Beam-Column Element

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/element/beam/2184-Elastic%20Beam%20Column%20Element/" class="md-nav__link">
        ElasticBeamColumn

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_3" type="checkbox" id="__nav_1_2_3" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2_3">
          Constraint
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Constraint" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_2_3">
          <span class="md-nav__icon md-icon"></span>
          Constraint
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/constraints/602-RigidLink/" class="md-nav__link">
        RigidLink

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_4" type="checkbox" id="__nav_1_2_4" >
      
      
      
        
          
        
          
            
          
        
          
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../library/modeling/pattern/plain/">Pattern</a>
          
            <label for="__nav_1_2_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Pattern" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_2_4">
          <span class="md-nav__icon md-icon"></span>
          Pattern
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/pattern/Multisupport_Excitation/" class="md-nav__link">
        Multisupport Excitation

      </a>
    </li>
  

            
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/pattern/740-Uniform%20Excitation%20Pattern/" class="md-nav__link">
        Uniform Excitation Pattern

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modeling/pattern/" class="md-nav__link">
        Load Patterns

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_3">
          Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utilities" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/utilities/units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3_2" type="checkbox" id="__nav_1_3_2" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_3_2">
          Recorders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Recorders" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_3_2">
          <span class="md-nav__icon md-icon"></span>
          Recorders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/utilities/recorders/208-Element%20Recorder/" class="md-nav__link">
        Element

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/utilities/recorders/431-Node%20Recorder/" class="md-nav__link">
        Node

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_4">
          Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modules" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4_1" type="checkbox" id="__nav_1_4_1" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_4_1">
          Algebraic Hysteresis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Algebraic Hysteresis" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_4_1">
          <span class="md-nav__icon md-icon"></span>
          Algebraic Hysteresis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modules/AlgebraicHysteresis/backbone/RaynorBackbone/" class="md-nav__link">
        Raynor

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modules/AlgebraicHysteresis/backbone/LinearCappedBackbone/" class="md-nav__link">
        LinearCapped

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modules/AlgebraicHysteresis/backbone/MultilinearBackbone/" class="md-nav__link">
        Multilinear

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modules/AlgebraicHysteresis/backbone/ArctangentBackbone/" class="md-nav__link">
        Arctangent

      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modules/AlgebraicHysteresis/backbone/ManderBackbone/" class="md-nav__link">
        Mander

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4_2" type="checkbox" id="__nav_1_4_2" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_4_2">
          Nonlinear Beam-Column
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Nonlinear Beam-Column" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_4_2">
          <span class="md-nav__icon md-icon"></span>
          Nonlinear Beam-Column
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../library/modules/NonlinearBeamColumn/geometry/370-Linear%20Transformation/" class="md-nav__link">
        Linear

      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="a-fortran-interface-for-uniaxialmaterial-models">A FORTRAN Interface for UniaxialMaterial Models</h1>
<p>Subclasses of UniaxialMaterial hide their implementation details from calling objects, i.e., calling objects only see the public interface defined in the UniaxialMaterial base class. How the interface is implemented is encapsulated by each subclass of UniaxialMaterial. Thus, a particular UniaxialMaterial implementation need not be written in C++ as long as the implementation conforms to the UniaxialMaterial interface.</p>
<p>As an example, the FEDEAS uniaxial material library developed by F.C. Filippou is used as a FORTRAN interface for UniaxialMaterial models in OpenSees. This example is meant to demonstrate the process of linking OpenSees with other material libraries and is not limited to just the FEDEAS library. Material libraries with any well-defined interface, e.g. DRAIN, may be linked in a similar manner. Similar concepts carry directly over to implementing NDMaterial and SectionForceDeformation models in FORTRAN.</p>
<h3 id="fedeas-subroutine-interface">FEDEAS subroutine interface</h3>
<p>The subroutine interface defined for a FEDEAS uniaxial material model named “ML1D” is shown below.</p>
<div class="highlight"><pre><span></span>subroutine ML1D(matpar,hstvP,hstv,epsP,sigP,deps,sig,tang,ist)
</pre></div>

<p>The subroutine arguments are given as follows:</p>
<ol type="1">
<li><p><code>matpar</code> - a double array of material parameters (in)</p></li>
<li><p><code>hstvP</code> - a double array of committed history variables (in)</p></li>
<li><p><code>hstv</code> - a double array of trial history variables (out)</p></li>
<li><p><code>epsP</code> - strain at the last committed state (in)</p></li>
<li><p><code>sigP</code> - stress at the last committed state (in)</p></li>
<li><p><code>deps</code> - change in strain from the last committed state (in)</p></li>
<li><p><code>sig</code> - the stress at the current trial state (out)</p></li>
<li><p><code>tang</code> - the tangent at the current trial state (out)</p></li>
<li><p><code>ist</code> - integer indicating the operation to be performed (in): 0 - return number of material parameters and history variables, 1 - compute stress and tangent, 2 - compute stress and secant</p></li>
</ol>
<h3 id="fedeasmaterial-implementation-in-opensees">FedeasMaterial Implementation in OpenSees</h3>
<p>This section presents an implementation of UniaxialMaterial capable of wrapping any subroutine that conforms to the FEDEAS interface described in the previous section. This implementation, FedeasMaterial, manages the data arrays sent to the FEDEAS subroutine, i.e., FedeasMaterial is responsible for storing the material parameters and history variables, as well as for swapping trial and committed history variables.</p>
<div class="center">
<p><img src="../FedeasMaterial.svg" /> </p>
</div>
<p>FedeasMaterial is a subclass of UniaxialMaterial, as shown in figure <a href="#fig:Fedeas" data-reference-type="ref" data-reference="fig:Fedeas">[fig:Fedeas$$</a>. Subclasses of FedeasMaterial are responsible for defining constructors which take the appropriate material parameters. All other functionality (state determination, swapping of history variables, etc.) is common to all subclasses of FedeasMaterial. Therefore, this functionality is defined in the base class, FedeasMaterial.</p>
<p>The FedeasMaterial class interface is shown below. All methods are declared as virtual so they may be overridden by subclasses of FedeasMaterial.</p>
<div class="highlight"><pre><span></span><span class="c1">#include &lt;UniaxialMaterial.h&gt;</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="n">FedeasMaterial</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">UniaxialMaterial</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">public</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="n">FedeasMaterial</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">classTag</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">nhv</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">ndata</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">FedeasMaterial</span><span class="p">();</span><span class="w"></span>
<span class="w">     </span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">setTrialStrain</span><span class="p">(</span><span class="n">double</span><span class="w"> </span><span class="n">strain</span><span class="p">,</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">strainRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">getStrain</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">getStress</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">getTangent</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">commitState</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">revertToLastCommit</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">);</span><span class="w">    </span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">revertToStart</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">);</span><span class="w">        </span>
<span class="w">     </span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="n">UniaxialMaterial</span><span class="w"> </span><span class="o">*</span><span class="n">getCopy</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">sendSelf</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">commitTag</span><span class="p">,</span><span class="w"> </span><span class="n">Channel</span><span class="w"> </span><span class="o">&amp;</span><span class="n">theChannel</span><span class="p">);</span><span class="w">  </span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">recvSelf</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">commitTag</span><span class="p">,</span><span class="w"> </span><span class="n">Channel</span><span class="w"> </span><span class="o">&amp;</span><span class="n">theChannel</span><span class="p">,</span><span class="w"> </span>
<span class="w">                          </span><span class="n">FEM_ObjectBroker</span><span class="w"> </span><span class="o">&amp;</span><span class="n">theBroker</span><span class="p">);</span><span class="w">    </span>
<span class="w">     </span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">Print</span><span class="p">(</span><span class="n">OPS_Stream</span><span class="w"> </span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">protected</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="n">Invokes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">FORTRAN</span><span class="w"> </span><span class="n">subroutine</span><span class="w"></span>
<span class="w">      </span><span class="n">virtual</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">invokeSubroutine</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">ist</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">      </span><span class="n">double</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">;</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">Material</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="n">array</span><span class="w"></span>
<span class="w">      </span><span class="n">double</span><span class="w"> </span><span class="o">*</span><span class="n">hstv</span><span class="p">;</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">History</span><span class="w"> </span><span class="n">array</span><span class="p">:</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">half</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">committed</span><span class="p">,</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">trial</span><span class="w"></span>
<span class="w">     </span>
<span class="w">      </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w">          </span><span class="o">//</span><span class="w"> </span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">material</span><span class="w"> </span><span class="n">parameters</span><span class="w"></span>
<span class="w">      </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">numHstv</span><span class="p">;</span><span class="w">          </span><span class="o">//</span><span class="w"> </span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">variables</span><span class="w"></span>
<span class="w">     </span>
<span class="w">      </span><span class="n">double</span><span class="w"> </span><span class="n">epsilonP</span><span class="p">;</span><span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="n">Committed</span><span class="w"> </span><span class="n">strain</span><span class="w"></span>
<span class="w">      </span><span class="n">double</span><span class="w"> </span><span class="n">sigmaP</span><span class="p">;</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">Committed</span><span class="w"> </span><span class="n">stress</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">private</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="n">double</span><span class="w"> </span><span class="n">epsilon</span><span class="p">;</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="n">Trial</span><span class="w"> </span><span class="n">strain</span><span class="w"></span>
<span class="w">      </span><span class="n">double</span><span class="w"> </span><span class="n">sigma</span><span class="p">;</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">Trial</span><span class="w"> </span><span class="n">stress</span><span class="w"></span>
<span class="w">      </span><span class="n">double</span><span class="w"> </span><span class="n">tangent</span><span class="p">;</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="n">Trial</span><span class="w"> </span><span class="n">tangent</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>

<p>Instance variables are declared in FedeasMaterial to store history variables and material parameters. First, data is a double array of size numData, the number of material parameters for this object. Next, hstv is a double array of size 2*numHstv, where numHstv is the number of history variables needed for this FedeasMaterial object. Note that committed history variables are stored in the first half of the hstv array, while the trial values are kept in the second half. The values epsilonP and sigmaP are the committed strain and stress, respectively, of this FedeasMaterial object, as they are required by the FEDEAS subroutine interface. Finally, three trial state variables, epsilon, sigma, and tangent are defined to store the current strain, stress, and tangent.</p>
<p>The FedeasMaterial constructor initializes the number of history variables and number of material parameters with arguments passed to the constructor. The UniaxialMaterial base class constructor is invoked with the tag and classTag arguments. The trial and committed strain and stress are initialized to <span class="math inline">\(0.0\)</span>. Then, the history variable and material parameter arrays are allocated. All entries in the history variable and material parameter arrays are initialized to <span class="math inline">\(0.0\)</span>.</p>
<div class="highlight"><pre><span></span><span class="nl">FedeasMaterial</span><span class="p">:</span><span class="err">:</span><span class="n">FedeasMaterial</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">classTag</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">nhv</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">ndata</span><span class="p">)</span><span class="w"></span>
<span class="err">:</span><span class="n">UniaxialMaterial</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span><span class="n">classTag</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="k">data</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">hstv</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">numData</span><span class="p">(</span><span class="n">ndata</span><span class="p">),</span><span class="w"> </span><span class="n">numHstv</span><span class="p">(</span><span class="n">nhv</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="n">epsilonP</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">sigmaP</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="n">epsilon</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">sigma</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">tangent</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numHstv</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">numHstv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numHstv</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="k">Allocate</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="k">array</span><span class="w"></span>
<span class="w">      </span><span class="n">hstv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">double</span><span class="o">[</span><span class="n">2*numHstv</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hstv</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">g3ErrorHandler</span><span class="o">-&gt;</span><span class="n">fatal</span><span class="p">(</span><span class="ss">&quot;%s -- failed to allocate history array -- type %d&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="ss">&quot;FedeasMaterial::FedeasMaterial&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getClassTag</span><span class="p">());</span><span class="w"></span>

<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="k">Initialize</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">hstv</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="err">}</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numData</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">numData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numData</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="k">Allocate</span><span class="w"> </span><span class="n">material</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="k">array</span><span class="w"></span>
<span class="w">      </span><span class="k">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">double</span><span class="o">[</span><span class="n">numData</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">data</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="n">g3ErrorHandler</span><span class="o">-&gt;</span><span class="n">fatal</span><span class="p">(</span><span class="ss">&quot;%s -- failed to allocate data array -- type %d&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="ss">&quot;FedeasMaterial::FedeasMaterial&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getClassTag</span><span class="p">());</span><span class="w"></span>

<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="k">Initialize</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">data</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="err">}</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</pre></div>

<p>The FedeasMaterial destructor deallocates the memory allocated in the constructor to hold the history variables and material parameters.</p>
<div class="highlight"><pre><span></span><span class="nt">FedeasMaterial</span><span class="o">::~</span><span class="nt">FedeasMaterial</span><span class="o">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="err">if</span><span class="w"> </span><span class="err">(hstv</span><span class="w"> </span><span class="err">!=</span><span class="w"> </span><span class="err">0)</span><span class="w"></span>
<span class="w">      </span><span class="err">delete</span><span class="w"> </span><span class="cp">[]</span><span class="w"> </span><span class="err">hstv</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="err">if</span><span class="w"> </span><span class="err">(data</span><span class="w"> </span><span class="err">!=</span><span class="w"> </span><span class="err">0)</span><span class="w"></span>
<span class="w">      </span><span class="err">delete</span><span class="w"> </span><span class="cp">[]</span><span class="w"> </span><span class="err">data</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>

<p>The next group of FedeasMaterial methods deals with material state determination. First, <code>setTrialStrain()</code> stores the trial strain, then invokes the FEDEAS subroutine with ist = 1, indicating that normal stress and tangent quantities should be computed. The methods <code>getStrain()</code>, <code>getStress()</code>, and <code>getTangent()</code> return the strain, stress, and tangent of this FedeasMaterial.</p>
<div class="highlight"><pre><span></span><span class="nt">int</span><span class="w"></span>
<span class="nt">FedeasMaterial</span><span class="p">::</span><span class="nd">setTrialStrain</span><span class="o">(</span><span class="nt">double</span><span class="w"> </span><span class="nt">strain</span><span class="o">,</span><span class="w"> </span><span class="nt">double</span><span class="w"> </span><span class="nt">strainRate</span><span class="o">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">Store</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">strain</span><span class="w"></span>
<span class="w">   </span><span class="err">epsilon</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">strain</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">Tells</span><span class="w"> </span><span class="err">subroutine</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">do</span><span class="w"> </span><span class="err">normal</span><span class="w"> </span><span class="err">operations</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">stress</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">tangent</span><span class="w"></span>
<span class="w">   </span><span class="err">int</span><span class="w"> </span><span class="err">ist</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">1</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">Call</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">subroutine</span><span class="w"></span>
<span class="w">   </span><span class="err">return</span><span class="w"> </span><span class="err">this-&gt;invokeSubroutine(ist)</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nt">double</span><span class="w"></span>
<span class="nt">FedeasMaterial</span><span class="p">::</span><span class="nd">getStrain</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="err">return</span><span class="w"> </span><span class="err">epsilon</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nt">double</span><span class="w"></span>
<span class="nt">FedeasMaterial</span><span class="p">::</span><span class="nd">getStress</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="err">return</span><span class="w"> </span><span class="err">sigma</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nt">double</span><span class="w"></span>
<span class="nt">FedeasMaterial</span><span class="p">::</span><span class="nd">getTangent</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="err">return</span><span class="w"> </span><span class="err">tangent</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>

<p>The next three methods deal with the path dependent behavior of this FedeasMaterial object. The <code>commitState()</code> method copies the trial history variables from the second half of the hstv array to the first half, where the committed values are stored. The committed values are copied to the trial values in <code>revertToLastCommit()</code>, and all values are set to <span class="math inline">\(0.0\)</span> in the <code>revertToStart()</code> method.</p>
<div class="highlight"><pre><span></span><span class="nc">int</span><span class="w"></span>
<span class="nl">FedeasMaterial</span><span class="p">:</span><span class="err">:</span><span class="n">commitState</span><span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="k">Set</span><span class="w"> </span><span class="n">committed</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">corresponding</span><span class="w"> </span><span class="n">trial</span><span class="w"> </span><span class="k">values</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">hstv</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hstv</span><span class="o">[</span><span class="n">i+numHstv</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">epsilonP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">epsilon</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">sigmaP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigma</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>

<span class="nc">int</span><span class="w"></span>
<span class="nl">FedeasMaterial</span><span class="p">:</span><span class="err">:</span><span class="n">revertToLastCommit</span><span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="k">Set</span><span class="w"> </span><span class="n">trial</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">corresponding</span><span class="w"> </span><span class="n">committed</span><span class="w"> </span><span class="k">values</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">hstv</span><span class="o">[</span><span class="n">i+numHstv</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hstv</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">epsilon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">epsilonP</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigmaP</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>

<span class="nc">int</span><span class="w"></span>
<span class="nl">FedeasMaterial</span><span class="p">:</span><span class="err">:</span><span class="n">revertToStart</span><span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="k">Set</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">trial</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">committed</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">hstv</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">epsilonP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">sigmaP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</pre></div>

<p>A copy of this FedeasMaterial object is returned by <code>getCopy()</code>. First, the FedeasMaterial constructor is called with the necessary tag, type, and array size data. Then, the committed strain and stress, all history variables, and material parameters are copied to the new object before it is returned.</p>
<div class="highlight"><pre><span></span><span class="n">UniaxialMaterial</span><span class="o">*</span><span class="w"></span>
<span class="nl">FedeasMaterial</span><span class="p">:</span><span class="err">:</span><span class="n">getCopy</span><span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="n">FedeasMaterial</span><span class="w"> </span><span class="o">*</span><span class="n">theCopy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">      </span><span class="k">new</span><span class="w"> </span><span class="n">FedeasMaterial</span><span class="p">(</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getTag</span><span class="p">(),</span><span class="w"> </span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getClassTag</span><span class="p">(),</span><span class="w"> </span><span class="n">numHstv</span><span class="p">,</span><span class="w"> </span><span class="n">numData</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Copy</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">variables</span><span class="w"></span>
<span class="w">   </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">theCopy</span><span class="o">-&gt;</span><span class="n">hstv</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hstv</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">theCopy</span><span class="o">-&gt;</span><span class="k">data</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">data</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">theCopy</span><span class="o">-&gt;</span><span class="n">epsilonP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">epsilonP</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">theCopy</span><span class="o">-&gt;</span><span class="n">sigmaP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigmaP</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">theCopy</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</pre></div>

<p>The next two methods are defined for parallel processing and database programming. The first method, <code>sendSelf()</code>, packs the tag and array size information for this FedeasMaterial object into an ID vector and sends it across the Channel. Then, the material properties and committed history variables are put in a Vector, and sent as well. The second method, <code>recvSelf()</code>, receives both the ID and Vector data from the Channel object, then populates the data of this FedeasMaterial object with the appropriate data.</p>
<div class="highlight"><pre><span></span><span class="nc">int</span><span class="w"> </span>
<span class="nl">FedeasMaterial</span><span class="p">:</span><span class="err">:</span><span class="n">sendSelf</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">commitTag</span><span class="p">,</span><span class="w"> </span><span class="n">Channel</span><span class="w"> </span><span class="o">&amp;</span><span class="n">theChannel</span><span class="p">)</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="nc">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">static</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">idData</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">idData</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getTag</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="n">idData</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numHstv</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">idData</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">res</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">theChannel</span><span class="p">.</span><span class="n">sendID</span><span class="p">(</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getDbTag</span><span class="p">(),</span><span class="w"> </span><span class="n">commitTag</span><span class="p">,</span><span class="w"> </span><span class="n">idData</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span>
<span class="w">      </span><span class="n">opserr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="ss">&quot;FedeasMaterial::sendSelf() - failed to send ID data\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">Vector</span><span class="w"> </span><span class="n">vecData</span><span class="p">(</span><span class="n">numHstv</span><span class="o">+</span><span class="n">numData</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Copy</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">committed</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">vector</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">vecData</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hstv</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Copy</span><span class="w"> </span><span class="n">material</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">vector</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">vecData</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">data</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">vecData</span><span class="p">(</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">epsilonP</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">vecData</span><span class="p">(</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigmaP</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">res</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">theChannel</span><span class="p">.</span><span class="n">sendVector</span><span class="p">(</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getDbTag</span><span class="p">(),</span><span class="w"> </span><span class="n">commitTag</span><span class="p">,</span><span class="w"> </span><span class="n">vecData</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span>
<span class="w">      </span><span class="n">opserr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="ss">&quot;FedeasMaterial::sendSelf() - failed to send Vector data\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>

<span class="nc">int</span><span class="w"></span>
<span class="nl">FedeasMaterial</span><span class="p">:</span><span class="err">:</span><span class="n">recvSelf</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">commitTag</span><span class="p">,</span><span class="w"> </span><span class="n">Channel</span><span class="w"> </span><span class="o">&amp;</span><span class="n">theChannel</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="n">FEM_ObjectBroker</span><span class="w"> </span><span class="o">&amp;</span><span class="n">theBroker</span><span class="p">)</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="nc">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">static</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">idData</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">res</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">theChannel</span><span class="p">.</span><span class="n">recvID</span><span class="p">(</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getDbTag</span><span class="p">(),</span><span class="w"> </span><span class="n">commitTag</span><span class="p">,</span><span class="w"> </span><span class="n">idData</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">      </span><span class="n">opserr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="ss">&quot;FedeasMaterial::recvSelf() - failed to receive ID data\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="err">}</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">this</span><span class="o">-&gt;</span><span class="n">setTag</span><span class="p">(</span><span class="n">idData</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span><span class="w"></span>
<span class="w">   </span><span class="n">numHstv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idData</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="n">numData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idData</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">Vector</span><span class="w"> </span><span class="n">vecData</span><span class="p">(</span><span class="n">numHstv</span><span class="o">+</span><span class="n">numData</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">res</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">theChannel</span><span class="p">.</span><span class="n">recvVector</span><span class="p">(</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getDbTag</span><span class="p">(),</span><span class="w"> </span><span class="n">commitTag</span><span class="p">,</span><span class="w"> </span><span class="n">vecData</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">      </span><span class="n">opserr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="ss">&quot;FedeasMaterial::recvSelf() - failed to receive Vector data\n&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="err">}</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Copy</span><span class="w"> </span><span class="n">committed</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">vector</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">hstv</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vecData</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Copy</span><span class="w"> </span><span class="n">material</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">vector</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numHstv</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">data</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vecData</span><span class="p">(</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">epsilonP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vecData</span><span class="p">(</span><span class="n">j</span><span class="o">++</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="n">sigmaP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">vecData</span><span class="p">(</span><span class="n">j</span><span class="o">++</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</pre></div>

<p>The <code>Print()</code> method outputs the name of this FedeasMaterial object to the stream passed as an argument. More cases can be added to the switch statement as additional subroutines are added.</p>
<div class="highlight"><pre><span></span><span class="nt">void</span><span class="w"></span>
<span class="nt">FedeasMaterial</span><span class="p">::</span><span class="nd">Print</span><span class="o">(</span><span class="nt">OPS_Stream</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">s</span><span class="o">,</span><span class="w"> </span><span class="nt">int</span><span class="w"> </span><span class="nt">flag</span><span class="o">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="err">s</span><span class="w"> </span><span class="err">&lt;&lt;</span><span class="w"> </span><span class="err">&quot;FedeasMaterial,</span><span class="w"> </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;;</span>
<span class="s2">           </span>
<span class="s2">   switch (this-&gt;getClassTag()) {</span>
<span class="s2">   case MAT_TAG_FedeasHardening:</span>
<span class="s2">      s &lt;&lt; &quot;</span><span class="n">Hardening</span><span class="s2">&quot; &lt;&lt; endln;</span>
<span class="s2">      break;</span>

<span class="s2">   // Add more cases as needed</span>
<span class="s2">       </span>
<span class="s2">   default:</span>
<span class="s2">      s &lt;&lt; &quot;</span><span class="n">Material</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">this-</span><span class="o">&gt;</span><span class="nf">getClassTag</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endln</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="err">break</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</pre></div>

<p>In order to link the FORTRAN subroutine with the OpenSees C++ libraries, the following external function declarations are needed. There are two syntactic styles for these declarations, one for Win32 and the other for everything else. The preprocessor directives put the proper declaration into the source code. Additional declarations may be added as more subroutines are included in OpenSees.</p>
<div class="highlight"><pre><span></span><span class="cp">#ifdef _WIN32</span>

<span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_stdcall</span><span class="w"> </span><span class="n">HARD_1</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">matpar</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">hstvP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">hstv</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">strainP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">stressP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">dStrain</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tangent</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">stress</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ist</span><span class="p">);</span><span class="w"></span>

<span class="cp">#define hard_1_ HARD_1</span>

<span class="c1">// Add more declarations as needed</span>

<span class="cp">#else</span>

<span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">hard_1_</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">matpar</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">hstvP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">hstv</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">strainP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">stressP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">dStrain</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">tangent</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">stress</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ist</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Add more declarations as needed</span>

<span class="cp">#endif</span>
</pre></div>

<p>The method <code>invokeSubroutine()</code> calls the appropriate subroutine based on the material classTag. The FedeasMaterial instance variables are passed to the FORTRAN subroutine from this method. Additional cases in the switch statement can be added as more subroutines are linked with OpenSees.</p>
<div class="highlight"><pre><span></span><span class="nc">int</span><span class="w"></span>
<span class="nl">FedeasMaterial</span><span class="p">:</span><span class="err">:</span><span class="n">invokeSubroutine</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">ist</span><span class="p">)</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="k">Compute</span><span class="w"> </span><span class="n">strain</span><span class="w"> </span><span class="n">increment</span><span class="w"></span>
<span class="w">   </span><span class="k">double</span><span class="w"> </span><span class="n">dEpsilon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">epsilon</span><span class="o">-</span><span class="n">epsilonP</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">getClassTag</span><span class="p">())</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">   </span><span class="k">case</span><span class="w"> </span><span class="nl">MAT_TAG_FedeasHardening</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="n">hard_1_</span><span class="p">(</span><span class="k">data</span><span class="p">,</span><span class="w"> </span><span class="n">hstv</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">hstv</span><span class="o">[</span><span class="n">numHstv</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">epsilonP</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sigmaP</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dEpsilon</span><span class="p">,</span><span class="w"> </span>
<span class="w">              </span><span class="o">&amp;</span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tangent</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ist</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">       </span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">needed</span><span class="w"></span>

<span class="w">   </span><span class="k">default</span><span class="err">:</span><span class="w"></span>
<span class="w">      </span><span class="n">g3ErrorHandler</span><span class="o">-&gt;</span><span class="n">fatal</span><span class="p">(</span><span class="ss">&quot;%s -- unknown material type&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="ss">&quot;FedeasMaterial::invokeSubroutine&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="err">}</span><span class="w"></span>
<span class="w">     </span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</pre></div>

<h3 id="example-fedeashardeningmaterial">Example – FedeasHardeningMaterial</h3>
<p>The material data array defined in FedeasMaterial is populated by its subclasses. As an example, consider the case where the uniaxial hardening material is coded in a FORTRAN subroutine. In order to link this subroutine with OpenSees, a subclass of FedeasMaterial, FedeasHardeningMaterial, must be created (see figure <a href="#fig:FedeasHardening" data-reference-type="ref" data-reference="fig:FedeasHardening">fig:FedeasHardening</a>). The functionality of this subclass is to populate the material parameter array and to determine the number of history variables required for analysis.</p>
<div class="center">
<figure>
<img src="../FedeasHardeningMaterial.svg" id="fig:FedeasHardening" alt="Fedeas hardening material" /><figcaption aria-hidden="true">Fedeas hardening material</figcaption>
</figure>
</div>
<p>As additional FEDEAS subroutines are added to OpenSees, new subclasses of FedeasMaterial must be added in order to populate the data array. This is all that need be done in the derived class as the base class, FedeasMaterial, contains all the computational code and keeps track of path dependent behavior. This functionality is inherited from the FedeasMaterial base class. However, the FedeasMaterial class must be modified such that the appropriate subroutine is called during state determination from the method <code>invokeSubroutine()</code>.</p>
<h4 id="fedeas-hardening-subroutine">FEDEAS Hardening Subroutine</h4>
<p>This section contains the implementation of the uniaxial hardening material coded as a FORTRAN subroutine using the FEDEAS interface. The subroutine declares local variables to store the material parameters passed through the matpar array. The committed history variables are received from hstvP, and the trial history variables are written to hstv upon return. The trial stress and tangent are also set upon return in the variables sig and tang.</p>
<details>
<summary>
FORTRAN source code
</summary>
<div class="highlight"><pre><span></span><span class="w">          </span><span class="k">subroutine </span><span class="n">Hard_1</span><span class="p">(</span><span class="n">matpar</span><span class="p">,</span><span class="n">hstvP</span><span class="p">,</span><span class="n">hstv</span><span class="p">,</span><span class="n">epsP</span><span class="p">,</span><span class="n">sigP</span><span class="p">,</span><span class="n">deps</span><span class="p">,</span><span class="n">sig</span><span class="p">,</span><span class="n">tang</span><span class="p">,</span><span class="n">ist</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">I</span><span class="w">  </span><span class="n">matpar</span><span class="w"> </span><span class="k">contains </span><span class="n">fixed</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">E</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Elastic</span><span class="w"> </span><span class="n">modulus</span><span class="w">             </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">matpar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">sigY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Yield</span><span class="w"> </span><span class="n">stress</span><span class="w">                </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">matpar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Hiso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isotropic</span><span class="w"> </span><span class="n">hardening</span><span class="w"> </span><span class="n">modulus</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">matpar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Hkin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kinematic</span><span class="w"> </span><span class="n">hardening</span><span class="w"> </span><span class="n">modulus</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">matpar</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">I</span><span class="w">  </span><span class="n">hstvP</span><span class="w"> </span><span class="k">contains </span><span class="n">committed</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">variables</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">ep</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">hstvP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">plastic</span><span class="w"> </span><span class="n">strain</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hstvP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">hardening</span><span class="w"> </span><span class="n">variable</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hstvP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">stress</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">kinematic</span><span class="w"> </span><span class="n">hardening</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">    </span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">O</span><span class="w">  </span><span class="n">hstv</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">trial</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">hstvP</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">hstv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ep</span><span class="w">    </span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">hstv</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">hstv</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kappa</span><span class="w"> </span>
<span class="w">    </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">I</span><span class="w">  </span><span class="n">epsP</span><span class="p">:</span><span class="w"> </span><span class="n">strain</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">committed</span><span class="w"> </span><span class="n">state</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">I</span><span class="w">  </span><span class="n">sigP</span><span class="p">:</span><span class="w"> </span><span class="n">stress</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">committed</span><span class="w"> </span><span class="n">state</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">I</span><span class="w">  </span><span class="n">deps</span><span class="p">:</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">strain</span><span class="w"> </span><span class="n">increment</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">O</span><span class="w">  </span><span class="n">sig</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">stress</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">O</span><span class="w">  </span><span class="n">tang</span><span class="p">:</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">tangent</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="n">I</span><span class="w">  </span><span class="n">ist</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">tangent</span><span class="w"> </span><span class="n">calculation</span><span class="w"> </span><span class="n">switch</span><span class="w"> </span>
<span class="w">    </span><span class="n">c</span><span class="w">             </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tangent</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incremental</span><span class="w"> </span><span class="n">secant</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">secant</span><span class="w"></span>

<span class="w">          </span><span class="k">implicit none</span>
<span class="k">     </span>
<span class="k">    </span><span class="n">c</span><span class="w">     </span><span class="n">Arguments</span><span class="w"></span>
<span class="w">          </span><span class="kt">integer </span><span class="n">ist</span><span class="w"></span>
<span class="w">          </span><span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w">  </span><span class="n">matpar</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">hstvP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">hstv</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w">  </span><span class="n">epsP</span><span class="p">,</span><span class="n">sigP</span><span class="p">,</span><span class="n">deps</span><span class="w"></span>
<span class="w">          </span><span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w">  </span><span class="n">sig</span><span class="p">,</span><span class="n">tang</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Local</span><span class="w"> </span><span class="n">variables</span><span class="w"></span>
<span class="w">          </span><span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w">  </span><span class="n">E</span><span class="p">,</span><span class="n">sigY</span><span class="p">,</span><span class="n">Hiso</span><span class="p">,</span><span class="n">Hkin</span><span class="w"></span>
<span class="w">          </span><span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w">  </span><span class="n">ep</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">kappa</span><span class="w">   </span>
<span class="w">          </span><span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w">  </span><span class="n">eps</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">xsi</span><span class="p">,</span><span class="n">dGamma</span><span class="w"></span>
<span class="w">          </span><span class="kt">integer </span><span class="n">sgn</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Material</span><span class="w"> </span><span class="n">parameters</span><span class="w"></span>
<span class="w">          </span><span class="n">E</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">matpar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="n">sigY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matpar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="n">Hiso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matpar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="n">Hkin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matpar</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">History</span><span class="w"> </span><span class="n">variables</span><span class="w"></span>
<span class="w">          </span><span class="n">ep</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">hstvP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hstvP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hstvP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Current</span><span class="w"> </span><span class="n">strain</span><span class="w"></span>
<span class="w">          </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">epsP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">deps</span><span class="w">    </span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Elastic</span><span class="w"> </span><span class="n">predictor</span><span class="w"></span>
<span class="w">          </span><span class="n">sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">eps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ep</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Stress</span><span class="w"> </span><span class="n">relative</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">stress</span><span class="w"></span>
<span class="w">          </span><span class="n">xsi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kappa</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Yield</span><span class="w"> </span><span class="k">function</span>
<span class="k">          </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dabs</span><span class="p">(</span><span class="n">xsi</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">sigY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Hiso</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Inside</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">surface</span><span class="w"></span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">             </span><span class="n">tang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Outside</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">surface</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">do return </span><span class="n">mapping</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span>
<span class="k">    </span><span class="n">c</span><span class="w">     </span><span class="n">Consistency</span><span class="w"> </span><span class="k">parameter</span>
<span class="k">             </span><span class="n">dGamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">E</span><span class="o">+</span><span class="n">Hiso</span><span class="o">+</span><span class="n">Hkin</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Normal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">surface</span><span class="w"></span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xsi</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">sgn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">             </span><span class="k">else</span>
<span class="k">                </span><span class="n">sgn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">             </span><span class="k">endif</span>

<span class="k">    </span><span class="n">c</span><span class="w">     </span><span class="n">Updated</span><span class="w"> </span><span class="n">stress</span><span class="w"></span>
<span class="w">             </span><span class="n">sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dGamma</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">sgn</span><span class="w"></span>
<span class="w">        </span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Updated</span><span class="w"> </span><span class="n">plastic</span><span class="w"> </span><span class="n">strain</span><span class="w"></span>
<span class="w">             </span><span class="n">ep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ep</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dGamma</span><span class="o">*</span><span class="n">sgn</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Updated</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">stress</span><span class="w"></span>
<span class="w">             </span><span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kappa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dGamma</span><span class="o">*</span><span class="n">Hkin</span><span class="o">*</span><span class="n">sgn</span><span class="w"></span>
<span class="w">        </span>
<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Updated</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">hardening</span><span class="w"> </span><span class="n">variable</span><span class="w"></span>
<span class="w">             </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dGamma</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Elasto</span><span class="o">-</span><span class="n">plastic</span><span class="w"> </span><span class="n">tangent</span><span class="w"></span>
<span class="w">             </span><span class="n">tang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">*</span><span class="p">(</span><span class="n">Hkin</span><span class="o">+</span><span class="n">Hiso</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">E</span><span class="o">+</span><span class="n">Hkin</span><span class="o">+</span><span class="n">Hiso</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">endif</span>

<span class="k">    </span><span class="n">c</span><span class="w">     </span><span class="n">Update</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">variables</span><span class="w"></span>
<span class="w">          </span><span class="n">hstv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ep</span><span class="w"></span>
<span class="w">          </span><span class="n">hstv</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alpha</span><span class="w"></span>
<span class="w">          </span><span class="n">hstv</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kappa</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="n">Compute</span><span class="w"> </span><span class="n">requested</span><span class="w"> </span><span class="n">tangent</span><span class="w"></span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ist</span><span class="o">==</span><span class="mf">2.</span><span class="nb">and</span><span class="p">.</span><span class="n">deps</span><span class="o">/=</span><span class="mf">0.d0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">tang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sig</span><span class="o">-</span><span class="n">sigP</span><span class="p">)</span><span class="o">/</span><span class="n">deps</span><span class="w"></span>
<span class="w">          </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">ist</span><span class="o">==</span><span class="mf">3.</span><span class="nb">and</span><span class="p">.</span><span class="n">eps</span><span class="o">/=</span><span class="mf">0.d0</span><span class="p">)</span><span class="k">then</span>
<span class="k">            </span><span class="n">tang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig</span><span class="o">/</span><span class="n">eps</span><span class="w"></span>
<span class="w">          </span><span class="k">else</span>
<span class="k">    </span><span class="n">c</span><span class="w">     </span><span class="n">add</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="k">if </span><span class="n">needed</span><span class="w"></span>
<span class="w">          </span><span class="k">endif          </span>

<span class="k">          return</span>

<span class="k">          end subroutine</span><span class="w"> </span>
</pre></div>

</details>
<h4 id="fedeashardeningmaterial-subclass">FedeasHardeningMaterial Subclass</h4>
<p>As stated previously, the functionality of the FedeasHardeningMaterial class is to read in the material parameters required for the Hard_1 subroutine invoked from the FedeasMaterial method <code>invokeSubroutine()</code>. In addition, the required number of history variables must be passed to the FedeasMaterial base class.</p>
<p>The class interface for FedeasHardeningMaterial is shown below. The constructor takes the tag and material parameters as arguments. No other methods are declared in the FedeasHardeningMaterial interface as all functionality is inherited from FedeasMaterial.</p>
<div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;FedeasMaterial.h&gt;</span><span class="cp"></span>

<span class="n">class</span><span class="w"> </span><span class="n">FedeasHardeningMaterial</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">FedeasMaterial</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">public</span><span class="o">:</span><span class="w"></span>
<span class="w">      </span><span class="n">FedeasHardeningMaterial</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sigmaY</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">double</span><span class="w"> </span><span class="n">Hiso</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">Hkin</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">FedeasHardeningMaterial</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="o">~</span><span class="n">FedeasHardeningMaterial</span><span class="p">();</span><span class="w"></span>

<span class="w">   </span><span class="n">protected</span><span class="o">:</span><span class="w"></span>

<span class="w">   </span><span class="n">private</span><span class="o">:</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>

<p>The constructor takes the tag, elastic modulus, yield stress, and isotropic and kinematic hardening moduli as arguments. The FedeasMaterial class constructor is called with the tag and classTag <code>MAT_TAG_FedeasHardening</code> defined in classTags.h and the number of history variables and material parameters required for this particular material model. Then the material parameters are inserted into the data array. The default constructor simply invokes the base class constructor, and the destructor does nothing.</p>
<div class="highlight"><pre><span></span><span class="n">FedeasHardeningMaterial</span><span class="p">::</span><span class="n">FedeasHardeningMaterial</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="n">double</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">sigmaY</span><span class="p">,</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">Hiso</span><span class="p">,</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="n">Hkin</span><span class="p">):</span><span class="w"></span>
<span class="o">//</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">material</span><span class="w"> </span><span class="n">parameters</span><span class="w"></span>
<span class="n">FedeasMaterial</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">MAT_TAG_FedeasHardening</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigmaY</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hiso</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hkin</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">FedeasHardeningMaterial</span><span class="p">::</span><span class="n">FedeasHardeningMaterial</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">):</span><span class="w"></span>
<span class="n">FedeasMaterial</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">MAT_TAG_FedeasHardening</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Does</span><span class="w"> </span><span class="n">nothing</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">FedeasHardeningMaterial</span><span class="p">::</span><span class="o">~</span><span class="n">FedeasHardeningMaterial</span><span class="p">(</span><span class="nb nb-Type">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Does</span><span class="w"> </span><span class="n">nothing</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>

<h4 id="important-polymorphic-note">Important Polymorphic Note</h4>
<p>Should any method in the FedeasMaterial class need to be overridden, e.g., if a subclass does not want all of its history variables set to <span class="math inline">\(0.0\)</span> in <code>revertToStart()</code>, the <code>getCopy()</code> method must also be overridden to return a pointer to the subclass. If <code>getCopy()</code> is not overridden, the dynamic type of the returned pointer will be of the FedeasMaterial type and the overridden method, e.g., <code>revertToStart()</code>, will not be called.</p>
<h3 id="tcl-model-builder">Tcl Model Builder</h3>
<p>Adding the FedeasHardeningMaterial model to the Tcl model builder is done in exactly the same manner as for HardeningMaterial since both models have the same material parameters. Only the material allocation would change. The following line in <code>TclModelBuilderUniaxialMaterialCommand.cpp</code></p>
<div class="highlight"><pre><span></span>      // Parsing was successful, allocate the material
      theMaterial = new HardeningMaterial(tag, E, sigmaY, Hiso, Hkin); 
</pre></div>

<p>would be changed to</p>
<div class="highlight"><pre><span></span><span class="c1">// Parsing was successful, allocate the material</span>
<span class="n">theMaterial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FedeasHardeningMaterial</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">sigmaY</span><span class="p">,</span><span class="w"> </span><span class="n">Hiso</span><span class="p">,</span><span class="w"> </span><span class="n">Hkin</span><span class="p">);</span><span class="w"> </span>
</pre></div>

<h3 id="fem_objectbroker"><code>FEM_ObjectBroker</code></h3>
<p>As for the HardeningMaterial class, an additional case needs to be added to the <code>getNewUniaxialMaterial()</code> method in FEM_ObjectBroker in order for the FedeasHardeningMaterial class to be used for parallel processing and database programming.</p>
<div class="highlight"><pre><span></span><span class="nt">UniaxialMaterial</span><span class="o">*</span><span class="w"></span>
<span class="nt">FEM_ObjectBroker</span><span class="p">::</span><span class="nd">getNewUniaxialMaterial</span><span class="o">(</span><span class="nt">int</span><span class="w"> </span><span class="nt">classTag</span><span class="o">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="err">switch(classTag)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>

<span class="w">   </span><span class="err">case</span><span class="w"> </span><span class="n">MAT_TAG_Hardening</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="n">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="nf">HardeningMaterial</span><span class="p">();</span><span class="w"></span>

<span class="w">   </span><span class="err">case</span><span class="w"> </span><span class="n">MAT_TAG_FedeasHardening</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="n">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="nf">FedeasHardeningMaterial</span><span class="p">();</span><span class="w"></span>

<span class="w">   </span><span class="err">//</span><span class="w"></span>
<span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">Additional</span><span class="w"> </span><span class="err">cases</span><span class="w"> </span><span class="err">not</span><span class="w"> </span><span class="err">shown</span><span class="w"></span>
<span class="w">   </span><span class="err">//</span><span class="w"></span>

<span class="w">   </span><span class="n">default</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="n">opserr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s2">&quot;FEM_ObjectBroker::getPtrNewUniaxialMaterial - &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="err">opserr</span><span class="w"> </span><span class="err">&lt;&lt;</span><span class="w"> </span><span class="err">&quot;</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">no</span><span class="w"> </span><span class="err">UniaxialMaterial</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">exists</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">class</span><span class="w"> </span><span class="err">tag</span><span class="w"> </span><span class="err">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="err">opserr</span><span class="w"> </span><span class="err">&lt;&lt;</span><span class="w"> </span><span class="err">classTag</span><span class="w"> </span><span class="err">&lt;&lt;</span><span class="w"> </span><span class="err">endln</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="err">return</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w">        </span>
<span class="err">}</span><span class="w"></span>
</pre></div>


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Berkeley, CA
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.top", "navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.2a1c317c.min.js"}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.ed9748b7.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>